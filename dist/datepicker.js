!function(e){"use strict";!function(e,t){void 0===t&&(t={});var a=t.insertAt;if("undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===a&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(':root{--dp-primary-color:#06c;--dp-sunday-color:#d63638;--dp-saturday-color:#06c;--dp-bg-color:#fff;--dp-text-color:#333;--dp-hover-bg:#f0f0f0;--dp-border-radius:8px;--dp-shadow:0 4px 20px rgba(0,0,0,.15)}.date-input-container{margin-bottom:20px}.date-input{background-color:#fff;background-image:url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="%23666" stroke-width="1.5" fill="none"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8"  y1="2" x2="8"  y2="6"/><line x1="3"  y1="10" x2="21" y2="10"/></svg>\');background-position:right 10px center;background-repeat:no-repeat;background-size:14px 14px;border:1px solid #ccc;border-radius:4px;cursor:pointer;font-size:14px;padding:8px 32px 8px 12px;width:200px}.date-picker-wrapper{display:inline-block;position:relative}.date-picker{background:var(--dp-bg-color);border-radius:var(--dp-border-radius);box-shadow:var(--dp-shadow);display:none;left:0;margin-top:4px;padding:12px;position:absolute;top:100%;width:280px;z-index:1000}.date-picker.show{display:block}.date-picker-controls{align-items:center;display:flex;justify-content:space-between;margin-bottom:12px;position:relative}.month-navigation{align-items:center;display:flex;gap:4px;left:50%;position:absolute;transform:translateX(-50%)}.today-button{background:#e6f2ff;border:none;border-radius:4px;color:var(--dp-primary-color);cursor:pointer;font-size:11px;margin-left:auto;padding:4px 12px;transition:background-color .2s}.today-button:hover{background-color:#cce5ff}.nav-button{align-items:center;background:transparent;border:none;border-radius:4px;color:#666;cursor:pointer;display:flex;flex-shrink:0;font-size:16px;height:24px;justify-content:center;transition:background-color .2s;width:24px}.nav-button:hover{background-color:var(--dp-hover-bg)}.month-year-display{color:var(--dp-text-color);font-size:14px;font-weight:500;text-align:center;white-space:nowrap}.calendar-day.sunday:not(.other-month),.weekday-header.sunday{color:var(--dp-sunday-color)}.calendar-day.saturday:not(.other-month),.weekday-header.saturday{color:var(--dp-saturday-color)}.calendar-grid{display:grid;gap:2px;grid-template-columns:repeat(7,1fr)}.weekday-header{color:#666;font-size:11px;font-weight:500;padding:4px 0;text-align:center}.calendar-day{align-items:center;aspect-ratio:1;background:transparent;border:none;border-radius:50%;cursor:pointer;display:flex;font-size:13px;justify-content:center;min-height:32px;padding:0;position:relative;transition:all .2s}.calendar-day:hover:not(.other-month):not(.selected){background-color:var(--dp-hover-bg)}.calendar-day.other-month{color:#ccc}.calendar-day.disabled,.calendar-day.disabled.saturday,.calendar-day.disabled.sunday{color:#ccc;cursor:not-allowed;pointer-events:none}.calendar-day.disabled:hover{background-color:transparent}.calendar-day.selected{background-color:var(--dp-primary-color);color:#fff;font-weight:500}.calendar-day.selected.sunday{background-color:var(--dp-sunday-color);color:#fff}.calendar-day.selected.saturday{color:#fff}.calendar-day.holiday:not(.other-month){color:var(--dp-sunday-color)}.calendar-day.holiday.selected{background-color:var(--dp-sunday-color);color:#fff}.calendar-day.disabled.holiday{color:#ccc}.calendar-day.today:not(.selected){font-weight:600}.calendar-day.today:not(.selected).sunday{color:var(--dp-sunday-color)}.calendar-day.today:not(.selected).saturday{color:var(--dp-saturday-color)}.calendar-day.today:not(.selected):after{background-color:currentColor;border-radius:50%;bottom:2px;content:"";height:3px;left:50%;position:absolute;transform:translateX(-50%);width:3px}.dp-overlay{display:none;inset:0;position:fixed;z-index:999}.dp-overlay.show{display:block}@media (max-width:768px){.date-picker{padding:10px;width:260px}.calendar-day{font-size:12px;min-height:28px}.nav-button{font-size:14px;height:20px;width:20px}.month-year-display{font-size:13px}.today-button{font-size:10px;padding:3px 8px}}');class t{static instances=[];constructor(e,a={}){this.wrapper=e,this.input=e.querySelector(".date-input"),this.config={format:"YYYY/MM/DD",minDate:null,maxDate:null,...a},this.minDate=this.parseDate(this.config.minDate),this.maxDate=this.parseDate(this.config.maxDate),this.holidays=a.holidays instanceof Set?a.holidays:new Set(a.holidays||[]),this.selectedDate=null,this.viewDate=new Date,t.instances.push(this),this.init()}parseDate(e){if(!e)return null;if("today"===e){const e=new Date;return e.setHours(0,0,0,0),e}if(e instanceof Date)return e;const t=String(e).match(/^(\d{4})-(\d{1,2})-(\d{1,2})$/);if(t)return new Date(parseInt(t[1]),parseInt(t[2])-1,parseInt(t[3]));const a=new Date(e);return isNaN(a)?null:a}isDisabled(e){const t=new Date(e);if(t.setHours(0,0,0,0),this.minDate){const e=new Date(this.minDate);if(e.setHours(0,0,0,0),t<e)return!0}if(this.maxDate){const e=new Date(this.maxDate);if(e.setHours(0,0,0,0),t>e)return!0}return!1}init(){this.createPicker(),this.attachEventListeners()}createPicker(){const e=document.createElement("div");e.className="date-picker",e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true"),e.setAttribute("aria-label","Date Picker"),e.innerHTML='\n            <div class="date-picker-controls">\n                <div class="month-navigation">\n                    <button type="button" class="nav-button prev-month" aria-label="Previous Month">‹</button>\n                    <div class="month-year-display" aria-live="polite"></div>\n                    <button type="button" class="nav-button next-month" aria-label="Next Month">›</button>\n                </div>\n                <button type="button" class="today-button">今日</button>\n            </div>\n            <div class="calendar-grid" role="grid"></div>\n        ',this.wrapper.appendChild(e),this.picker=e,this.monthYearDisplay=e.querySelector(".month-year-display"),this.calendarGrid=e.querySelector(".calendar-grid"),this.prevButton=e.querySelector(".prev-month"),this.nextButton=e.querySelector(".next-month"),this.todayButton=e.querySelector(".today-button"),this.createOverlay()}createOverlay(){if(!document.querySelector(".dp-overlay")){const e=document.createElement("div");e.className="dp-overlay",document.body.appendChild(e)}}attachEventListeners(){this._onInputClick=()=>this.show(),this._onInputKeydown=e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.show()),"Escape"===e.key&&this.picker.classList.contains("show")&&(e.preventDefault(),this.hide())},this._onDocumentClick=e=>{this.wrapper.contains(e.target)||this.picker.contains(e.target)||this.hide()},this.input.addEventListener("click",this._onInputClick),this.input.addEventListener("keydown",this._onInputKeydown),this.prevButton.addEventListener("click",e=>{e.stopPropagation(),this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()-1,1),this.updateCalendar()}),this.nextButton.addEventListener("click",e=>{e.stopPropagation(),this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()+1,1),this.updateCalendar()}),this.todayButton.addEventListener("click",e=>{e.stopPropagation();const t=new Date;this.isDisabled(t)||(this.selectedDate=t,this.viewDate=new Date,this.updateCalendar(),this.setInputValue(),this.hide(),this.input.focus())}),document.addEventListener("click",this._onDocumentClick),this.picker.addEventListener("keydown",e=>{"Escape"===e.key&&(e.preventDefault(),this.hide(),this.input.focus())}),this.picker.addEventListener("keydown",e=>{if("Tab"!==e.key)return;const t=this.picker.querySelectorAll('button:not([disabled]):not([tabindex="-1"])');if(0===t.length)return;const a=t[0],n=t[t.length-1];e.shiftKey&&document.activeElement===a?(e.preventDefault(),n.focus()):e.shiftKey||document.activeElement!==n||(e.preventDefault(),a.focus())}),this.calendarGrid.addEventListener("keydown",e=>{const t=Array.from(this.calendarGrid.querySelectorAll(".calendar-day:not(.disabled)")),a=t.indexOf(document.activeElement);if(-1===a)return;let n=-1;switch(e.key){case"ArrowRight":if(e.preventDefault(),n=a+1,n>=t.length)return this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()+1,1),this.updateCalendar(),void this.focusDayByIndex(0);break;case"ArrowLeft":if(e.preventDefault(),n=a-1,n<0)return this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()-1,1),this.updateCalendar(),void this.focusDayByIndex(-1);break;case"ArrowDown":if(e.preventDefault(),n=a+7,n>=t.length)return this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()+1,1),this.updateCalendar(),void this.focusDayByIndex(0);break;case"ArrowUp":if(e.preventDefault(),n=a-7,n<0)return this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()-1,1),this.updateCalendar(),void this.focusDayByIndex(-1);break;case"Home":e.preventDefault(),n=0;break;case"End":e.preventDefault(),n=t.length-1;break;case"PageUp":return e.preventDefault(),this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()-1,1),this.updateCalendar(),void this.focusDayByIndex(Math.min(a,this.getEnabledDayCount()-1));case"PageDown":return e.preventDefault(),this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()+1,1),this.updateCalendar(),void this.focusDayByIndex(Math.min(a,this.getEnabledDayCount()-1));case"Enter":case" ":return e.preventDefault(),void t[a].click();default:return}n>=0&&n<t.length&&t[n].focus()})}focusDayByIndex(e){const t=this.calendarGrid.querySelectorAll(".calendar-day:not(.disabled)");if(0===t.length)return;const a=e<0?t.length+e:e;t[Math.max(0,Math.min(a,t.length-1))].focus()}getEnabledDayCount(){return this.calendarGrid.querySelectorAll(".calendar-day:not(.disabled)").length}show(){t.instances.forEach(e=>{e!==this&&e.closePicker()}),this.updateCalendar(),this.picker.classList.add("show"),document.querySelector(".dp-overlay").classList.add("show");const e=this.calendarGrid.querySelector(".calendar-day.selected:not(.disabled)"),a=this.calendarGrid.querySelector(".calendar-day.today:not(.disabled)"),n=this.calendarGrid.querySelector(".calendar-day:not(.disabled):not(.other-month)"),i=e||a||n;i&&i.focus()}closePicker(){this.picker.classList.remove("show")}hide(){this.picker.classList.remove("show");t.instances.some(e=>e.picker.classList.contains("show"))||document.querySelector(".dp-overlay").classList.remove("show")}updateCalendar(){const e=this.viewDate.getFullYear(),t=this.viewDate.getMonth();this.monthYearDisplay.textContent=`${e}年${t+1}月`,this.calendarGrid.innerHTML="";["日","月","火","水","木","金","土"].forEach((e,t)=>{const a=document.createElement("div");a.className="weekday-header",0===t&&a.classList.add("sunday"),6===t&&a.classList.add("saturday"),a.textContent=e,a.setAttribute("role","columnheader"),this.calendarGrid.appendChild(a)});const a=new Date(e,t,1),n=new Date(e,t+1,0),i=new Date(e,t,0),r=a.getDay();for(let a=r-1;a>=0;a--){const n=i.getDate()-a;this.createDayElement(new Date(e,t-1,n),!0)}for(let a=1;a<=n.getDate();a++)this.createDayElement(new Date(e,t,a),!1);const s=42-(r+n.getDate());for(let a=1;a<=s;a++)this.createDayElement(new Date(e,t+1,a),!0)}createDayElement(e,t){const a=document.createElement("button");a.className="calendar-day",a.textContent=e.getDate(),a.setAttribute("type","button");const n=e.getDay();0===n&&a.classList.add("sunday"),6===n&&a.classList.add("saturday"),this.isHoliday(e)&&a.classList.add("holiday"),t&&a.classList.add("other-month"),this.isToday(e)&&a.classList.add("today"),this.selectedDate&&this.isSameDay(e,this.selectedDate)&&(a.classList.add("selected"),a.setAttribute("aria-selected","true"));this.isDisabled(e)?(a.classList.add("disabled"),a.setAttribute("disabled","true"),a.setAttribute("tabindex","-1")):(a.setAttribute("tabindex",t?"-1":"0"),a.addEventListener("click",t=>{t.stopPropagation(),this.selectedDate=e,this.viewDate=new Date(e),this.updateCalendar(),this.setInputValue(),this.hide(),this.input.focus()})),this.calendarGrid.appendChild(a)}isToday(e){return this.isSameDay(e,new Date)}isSameDay(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}isHoliday(e){const t=`${e.getFullYear()}/${e.getMonth()+1}/${e.getDate()}`;return this.holidays.has(t)}setInputValue(){if(!this.selectedDate)return;const e=this.selectedDate.getFullYear(),t=String(this.selectedDate.getMonth()+1).padStart(2,"0"),a=String(this.selectedDate.getDate()).padStart(2,"0");let n=this.config.format.replace("YYYY",e).replace("MM",t).replace("DD",a);this.input.value=n,this.input.dispatchEvent(new Event("change",{bubbles:!0}))}destroy(){this.hide(),document.removeEventListener("click",this._onDocumentClick),this.input.removeEventListener("click",this._onInputClick),this.input.removeEventListener("keydown",this._onInputKeydown),this.picker.remove();const e=t.instances.indexOf(this);if(-1!==e&&t.instances.splice(e,1),0===t.instances.length){const e=document.querySelector(".dp-overlay");e&&e.remove()}}}if("undefined"!=typeof document){const e=function(){const e=document.currentScript||(()=>{const e=document.querySelectorAll("script[src]");return e[e.length-1]})();return e&&e.src?e.src.substring(0,e.src.lastIndexOf("/")+1):""}()+"holiday.csv",a=e=>{document.querySelectorAll(".date-picker-wrapper").forEach(a=>{const n={holidays:e};a.dataset.minDate&&(n.minDate=a.dataset.minDate),a.dataset.maxDate&&(n.maxDate=a.dataset.maxDate),a.dataset.format&&(n.format=a.dataset.format),new t(a,n)})},n=()=>{fetch(e).then(e=>{if(!e.ok)throw new Error(e.status);return e.text()}).then(e=>function(e){const t=new Set,a=/^(\d{4}\/\d{1,2}\/\d{1,2})/,n=e.split(/\r?\n/);for(const e of n){const n=e.match(a);n&&t.add(n[1])}return t}(e)).catch(()=>new Set).then(e=>a(e))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n()}e.DatePicker=t}(this.DatePicker=this.DatePicker||{});
